<div class="customer-creation-container">
  <mat-card class="creation-card">
    <mat-card-header>
      <mat-card-title>Create Your Account</mat-card-title>
      <mat-card-subtitle>Fill in your details to get started</mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <!-- Success Message -->
      @if (successMessage()) {
        <div class="success-banner">
          <mat-icon>check_circle</mat-icon>
          <span>{{ successMessage() }}</span>
        </div>
      }

      <!-- Error Message -->
      @if (error()) {
        <div class="error-banner">
          <mat-icon>error</mat-icon>
          <span>{{ error() }}</span>
        </div>
      }

      <form [formGroup]="customerForm" (ngSubmit)="onSubmit()">
        <!-- Account Credentials Section -->
        <div class="form-section">
          <h3 class="section-title">
            <mat-icon>account_circle</mat-icon>
            Account Credentials
          </h3>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Email</mat-label>
            <input matInput type="email" formControlName="email" placeholder="your.email@example.com" required>
            <mat-icon matPrefix>email</mat-icon>
            <mat-error>{{ getEmailErrorMessage() }}</mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Password</mat-label>
            <input
              matInput
              [type]="hidePassword() ? 'password' : 'text'"
              formControlName="password"
              placeholder="Enter a strong password"
              required>
            <mat-icon matPrefix>lock</mat-icon>
            <button mat-icon-button matSuffix type="button" (click)="togglePasswordVisibility()">
              <mat-icon>{{ hidePassword() ? 'visibility_off' : 'visibility' }}</mat-icon>
            </button>
            <mat-error>{{ getPasswordErrorMessage() }}</mat-error>
            <mat-hint>Must be at least 8 characters with uppercase, lowercase, number, and special character</mat-hint>
          </mat-form-field>
        </div>

        <!-- Personal Information Section -->
        <div class="form-section">
          <h3 class="section-title">
            <mat-icon>person</mat-icon>
            Personal Information
          </h3>

          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>First Name</mat-label>
              <input matInput formControlName="firstName" placeholder="John" required>
              <mat-error>First name is required</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Last Name</mat-label>
              <input matInput formControlName="lastName" placeholder="Doe" required>
              <mat-error>Last name is required</mat-error>
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Phone Number</mat-label>
            <input matInput type="tel" formControlName="phoneNumber" placeholder="+1 (555) 123-4567" required>
            <mat-icon matPrefix>phone</mat-icon>
            <mat-error>Phone number is required</mat-error>
          </mat-form-field>
        </div>

        <!-- Address Section -->
        <div class="form-section">
          <h3 class="section-title">
            <mat-icon>home</mat-icon>
            Address
          </h3>

          <div class="form-row">
            <mat-form-field appearance="outline" class="street-number">
              <mat-label>Street Number</mat-label>
              <input matInput formControlName="streetNumber" placeholder="123" required>
              <mat-error>Required</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline" class="street">
              <mat-label>Street</mat-label>
              <input matInput formControlName="street" placeholder="Main Street" required>
              <mat-error>Street is required</mat-error>
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>City</mat-label>
            <input matInput formControlName="city" placeholder="New York" required>
            <mat-error>City is required</mat-error>
          </mat-form-field>

          <div class="form-row">
            <mat-form-field appearance="outline">
              <mat-label>Region/State</mat-label>
              <input matInput formControlName="region" placeholder="NY" required>
              <mat-error>Region is required</mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Postal Code</mat-label>
              <input matInput formControlName="postalCode" placeholder="10001" required>
              <mat-error>Postal code is required</mat-error>
            </mat-form-field>
          </div>

          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Country</mat-label>
            <input matInput formControlName="country" placeholder="United States" required>
            <mat-error>Country is required</mat-error>
          </mat-form-field>
        </div>

        <!-- Submit Button -->
        <div class="button-container">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="loading() || !!successMessage()">
            @if (loading()) {
              <mat-spinner diameter="20"></mat-spinner>
              <span>Creating Account...</span>
            } @else {
              <ng-container>
                <mat-icon>person_add</mat-icon>
                <span>Create Account</span>
              </ng-container>
            }
          </button>

          <button
            mat-stroked-button
            type="button"
            routerLink="/login"
            [disabled]="loading()">
            Already have an account? Sign in
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>